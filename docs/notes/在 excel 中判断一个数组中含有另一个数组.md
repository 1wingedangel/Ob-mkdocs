---
title: 在 excel 中判断一个数组中含有另一个数组
class: activity
status: done
created-date: 2024-02-16T09:59:17.545+08:00
tags:
  - date/2024/02/16
aliases: 
related:
  - "[Excel](Excel.md)"
share: true
---

%%
> [!example]+ **Comments:**     
>  | Date___ | Comments |
> | ------- | -------- |
> 
>  **Comment**:: 
%%

# 在 excel 中判断一个数组中含有另一个数组

主要在 `FILTER` 函数中使用。用于进行多个条件的联合判断。

## 在Excel中如何判断一个数组中含有另一个数组的元素

在excel上如何判断一个数组中含有另一个数组元素的情况？比如 `{1,2,3,4,5,6,7}` 中搜索 `{2,4,7}` ，返回 {0,1,0,1,0,0,1}

### ChatGPT的回答

在Excel中，你可以使用一系列的函数和数组公式来判断一个数组中是否含有另一个数组的元素。以下是一个步骤和示例，展示如何实现你的需求。

假设你的大数组（{1,2,3,4,5,6,7}）位于A1:G1单元格中，而你要搜索的小数组（{2,4,7}）位于A2:C2单元格中。你想在A3:G3中得到结果数组（{0,1,0,1,0,0,1}）。

#### 使用`MATCH`和`ISNUMBER`函数组合

1. **单元格公式（逐个填充）**:
   在A3单元格中输入以下公式，然后向右拖动填充至G3单元格。
   ```excel
   =--ISNUMBER(MATCH(A1,$A$2:$C$2,0))
   ```
   这个公式利用`MATCH`函数搜索A1单元格的值在A2:C2范围内的位置。如果找到，`MATCH`函数返回该值在数组中的相对位置，否则返回错误。`ISNUMBER`函数用于检查`MATCH`函数的结果是否为数字（即是否找到了匹配项）。`--`（双负号）用于将`TRUE`/`FALSE`值转换为`1`/`0`。

2. **数组公式（单一公式适用于整个范围）**:
   如果你使用的是支持动态数组的Excel版本（例如Excel 365），你可以在A3单元格中输入以下公式，然后按`Enter`键。Excel将自动填充相关的单元格。
   ```excel
   =--ISNUMBER(MATCH(A1:G1,$A$2:$C$2,0))
   ```
   请注意，这个公式假设你的Excel版本支持动态数组。如果不支持，你需要选择A3:G3区域，输入上面的公式，然后同时按下`Ctrl` + `Shift` + `Enter`键，将其作为数组公式输入。

#### 结果解释
这个方法的结果将是一个由`1`和`0`组成的数组，其中`1`表示大数组中的相应元素在小数组中找到了，`0`表示没有找到。这正是你要找的{0,1,0,1,0,0,1}。

#### 注意
- 动态数组功能是在较新版本的Excel中引入的（例如Excel 365）。如果你使用的版本不支持动态数组，你可能需要使用`Ctrl` + `Shift` + `Enter`来输入数组公式。
- 按需调整单元格引用以适应你的具体数据位置。